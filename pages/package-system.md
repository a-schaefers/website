---
title: Package System
category: main
---

The package system that KISS employs is a new concept that came to me (*Dylan Araps*) in a dream one night. The concept is simple; a set of plain text files separated by lines and spaces. Easily parseable in any programming language or with standard tools.


## Index

<!-- vim-markdown-toc GFM -->

* [The structure](#the-structure)
* [Installation](#installation)
* [Build](#build)
* [Dependencies](#dependencies)
* [Sources](#sources)
* [Version](#version)

<!-- vim-markdown-toc -->


## The structure

```sh
zlib/            # Package name.
├─ build         # Build script.
├─ depends       # Dependencies (one per line) (sometimes optional).
├─ sources       # Sources (one per line).
├─ version       # Package version.
┘

# Files generated by the package manager.
├─ checksums     # The checksums for the source files.
┘

# Optional files.
├─ post_install  # Script to run after package installation.
├─ patches/*     # Directory to store patches.
├─ files/*       # Directory to misc files.
├─ nostrip       # Don't strip binaries for this package (empty file).
┘
```

## Installation

When a package is installed, this entire directory tree is copied to `/var/db/kiss` where it becomes a database entry. Listing the dependencies for a package is a simple as printing the contents of the `depends` file. Searching for which package owns a file is as simple as checking each `manifest` file.

## Build

The `build` file should contain all of the steps required to patch, configure, build and install the package.

The current directory of the script is the source directory of the package, there is no need to `cd` anywhere. The script is passed a single argument which points to the directory the package should be installed to (`make DESTDIR="$1" install`).

**Simple example**:

```
#!/bin/sh -e

./configure \
    --prefix=/usr \
    --sysconfdir=/etc

make
make DESTDIR="$1" install
```

## Dependencies

The `depends`file should contain the package's dependencies one per line. A second column on each line is available to specify whether the dependency is needed only to build the package or if it is also required at runtime.

Comments are also supported using `#` at the start of the line. This allows simple package configuration through commented dependencies.

**Simple example**:

```
autoconf make
curl
libressl make
perl
zlib     make
```

## Sources

The `sources` file should contain all remote and local source files required during the build process, one per line. A second column on each line is available to specify the extraction directory or location in which a source should be available.

For example; this is used in `gcc`'s package to extract the source to a subdirectory called `gcc`.

**Simple example**:

```
https://gcc.gnu.org/pub/gcc/releases/gcc-9.1.0/gcc-9.1.0.tar.xz gcc
https://gmplib.org/download/gmp/gmp-6.1.2.tar.xz gcc/gmp
http://www.mpfr.org/mpfr-4.0.2/mpfr-4.0.2.tar.xz gcc/mpfr
https://ftp.gnu.org/gnu/mpc/mpc-1.1.0.tar.gz gcc/mpc
files/c99
```

## Version
